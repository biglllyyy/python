import redis
import asyncio
import random
import datetime

r = redis.Redis(host='10.3.236.238', port=6379,db=0)
a={
	"time": "2017-08-29 10:38:49",
	"start_char": "##",
	"cmd_ID": 2,
	"response_flag": 254,
	"VIN": "LDPGABAC8HB103225",
	"data_enc": 1,
	"data_unit_len": 642,
	"bj_year": 17,
	"bj_month": 8,
	"bj_day": 29,
	"bj_hour": 10,
	"bj_minute": 38,
	"bj_second": 49,
	"vehicle": {
		"vehicle_status": 2,
		"charge_state": 3,
		"run_model": 1,
		"speed": 0,
		"accu_mile": 5350,
		"total_voltage": 3783,
		"total_current": 10000,
		"SOC": 30,
		"DC_DC_status": 2,
		"gear": 0,
		"IR": 14393,
		"accel_pedal_travel": 0,
		"brake_pedal_status": 0
	},
	"drive_motor": {
		"total_drive_motor": 1,
		"info_list": [
			{
				"DM_serial": 1,
				"DM_status": 3,
				"DM_CON_TEMP": 63,
				"DM_speed": 20000,
				"DM_torque": 20000,
				"DM_TEMP": 63,
				"motor_CON_in_V": 0,
				"motor_CON_DC_bus_C": 10000
			}
		]
	},
	"vehicle_location": {
		"location_state": 0,
		"longitude": 114454664,
		"latitude": 38125012
	},
	"extreme": {
		"max_V_bat_subsys_serial": 1,
		"max_V_bat_mer_code": 96,
		"max_bat_mer_V": 3621,
		"min_V_bat_subsys_serial": 1,
		"min_V_bat_mer_code": 48,
		"min_bat_mer_V": 3606,
		"max_TEMP_subsys_serial": 1,
		"max_TEMP_probe_serial": 2,
		"max_TEMP": 60,
		"min_TEMP_subsys_serial": 1,
		"min_TEMP_probe_serial": 1,
		"min_TEMP": 59
	},
	"alarm": {
		"max_level": 0,
		"general_sign": 0,
		"total_device_fault": 0,
		"total_DM_fault": 0,
		"total_engine_fault": 0,
		"total_other_fault": 0
	},
	"temp": {
		"total_subsys": 1,
		"info_list": [
			{
				"subsys_serial": 1,
				"total_TEMP_probe": 52,
				"each_TEMP_probe_detect": [
					59,
					60,
					60,
					60,
					60,
					59,
					59,
					59,
					60,
					60,
					59,
					59,
					59,
					59,
					59,
					59,
					59,
					59,
					59,
					59,
					59,
					59,
					59,
					59,
					59,
					59,
					60,
					60,
					60,
					60,
					60,
					60,
					60,
					60,
					59,
					60,
					60,
					60,
					59,
					60,
					59,
					59,
					59,
					59,
					59,
					59,
					59,
					59,
					59,
					59,
					59,
					59
				]
			}
		]
	},
	"voltage": {
		"total_subsys": 1,
		"info_list": [
			{
				"subsys_serial": 1,
				"voltage": 3783,
				"current": 10000,
				"total_mer_battery": 208,
				"start_frame_bat_serial": 1,
				"total_frame_mer_bat": 200,
				"mer_bat_voltage": [
					3618,
					3618,
					3619,
					3618,
					3618,
					3618,
					3619,
					3616,
					3618,
					3618,
					3618,
					3618,
					3619,
					3619,
					3617,
					3618,
					3618,
					3619,
					3619,
					3619,
					3618,
					3618,
					3616,
					3618,
					3619,
					3618,
					3619,
					3618,
					3618,
					3619,
					3618,
					3618,
					3618,
					3619,
					3618,
					3618,
					3619,
					3619,
					3619,
					3619,
					3619,
					3619,
					3619,
					3619,
					3619,
					3619,
					3619,
					3606,
					3619,
					3619,
					3617,
					3618,
					3618,
					3616,
					3618,
					3618,
					3618,
					3619,
					3618,
					3619,
					3618,
					3618,
					3617,
					3617,
					3618,
					3618,
					3618,
					3617,
					3618,
					3618,
					3617,
					3617,
					3618,
					3618,
					3616,
					3618,
					3619,
					3618,
					3617,
					3615,
					3618,
					3619,
					3619,
					3618,
					3618,
					3619,
					3619,
					3619,
					3619,
					3619,
					3619,
					3618,
					3620,
					3620,
					3615,
					3622,
					3619,
					3622,
					3620,
					3619,
					3611,
					3621,
					3620,
					3620,
					3620,
					3619,
					3619,
					3619,
					3617,
					3617,
					3618,
					3619,
					3619,
					3619,
					3619,
					3617,
					3620,
					3619,
					3615,
					3617,
					3617,
					3619,
					3619,
					3619,
					3618,
					3611,
					3618,
					3619,
					3618,
					3619,
					3619,
					3617,
					3620,
					3619,
					3620,
					3619,
					3620,
					3617,
					3619,
					3619,
					3618,
					3614,
					3618,
					3619,
					3621,
					3621,
					3618,
					3619,
					3618,
					3619,
					3619,
					3618,
					3619,
					3618,
					3617,
					3618,
					3618,
					3619,
					3620,
					3620,
					3615,
					3617,
					3618,
					3618,
					3620,
					3619,
					3619,
					3618,
					3618,
					3619,
					3618,
					3620,
					3618,
					3618,
					3618,
					3620,
					3618,
					3620,
					3619,
					3619,
					3608,
					3619,
					3620,
					3621,
					3618,
					3618,
					3619,
					3618,
					3620,
					3618,
					3619,
					3618,
					3618,
					3619,
					3619,
					3619,
					3620,
					3620,
					3618,
					3619
				]
			}
		]
	},
	"check_code": 57
}
b={
	"time": "gai",
	"start_char": "##",
	"cmd_ID": 2,
	"response_flag": 254,
	"VIN": "gai",
	"data_enc": 1,
	"data_unit_len": 378,
	"bj_year": 17,
	"bj_month": 8,
	"bj_day": 29,
	"bj_hour": 9,
	"bj_minute": 58,
	"bj_second": 54,
	"vehicle": {
		"vehicle_status": 1,
		"charge_state": 3,
		"run_model": 1,
		"speed": 200,
		"accu_mile": 21960,
		"total_voltage": 4109,
		"total_current": 10287,
		"SOC": 87,
		"DC_DC_status": 1,
		"gear": 46,
		"IR": 15688,
		"accel_pedal_travel": 23,
		"brake_pedal_status": 0
	},
	"drive_motor": {
		"total_drive_motor": 1,
		"info_list": [
			{
				"DM_serial": 1,
				"DM_status": 1,
				"DM_CON_TEMP": 78,
				"DM_speed": 20929,
				"DM_torque": 21810,
				"DM_TEMP": 82,
				"motor_CON_in_V": 4120,
				"motor_CON_DC_bus_C": 10500
			}
		]
	},
	"vehicle_location": {
		"location_state": 0,
		"longitude": 114199768,
		"latitude": 30641144
	},
	"extreme": {
		"max_V_bat_subsys_serial": 1,
		"max_V_bat_mer_code": 0,
		"max_bat_mer_V": 65535,
		"min_V_bat_subsys_serial": 1,
		"min_V_bat_mer_code": 0,
		"min_bat_mer_V": 65535,
		"max_TEMP_subsys_serial": 1,
		"max_TEMP_probe_serial": 2,
		"max_TEMP": 69,
		"min_TEMP_subsys_serial": 1,
		"min_TEMP_probe_serial": 1,
		"min_TEMP": 68
	},
	"alarm": {
		"max_level": 0,
		"general_sign": 0,
		"total_device_fault": 0,
		"total_DM_fault": 0,
		"total_engine_fault": 0,
		"total_other_fault": 0
	},
	"temp": {
		"total_subsys": 1,
		"info_list": [
			{
				"subsys_serial": 1,
				"total_TEMP_probe": 52,
				"each_TEMP_probe_detect": [
					68,
					69,
					68,
					69,
					69,
					69,
					69,
					69,
					69,
					69,
					69,
					69,
					68,
					69,
					68,
					68,
					68,
					69,
					69,
					68,
					68,
					69,
					68,
					68,
					68,
					68,
					69,
					69,
					69,
					69,
					69,
					69,
					69,
					69,
					69,
					69,
					69,
					69,
					68,
					68,
					69,
					69,
					69,
					69,
					69,
					69,
					69,
					69,
					69,
					69,
					69,
					68
				]
			}
		]
	},
	"voltage": {
		"total_subsys": 1,
		"info_list": [
			{
				"subsys_serial": 1,
				"voltage": 4109,
				"current": 10287,
				"total_mer_battery": 208,
				"start_frame_bat_serial": 201,
				"total_frame_mer_bat": 8,
				"mer_bat_voltage": [
					3964,
					3964,
					3964,
					3964,
					3966,
					3959,
					3964,
					3965
				]
			}
		]
	},
	"check_code": 52
}


firstTime=datetime.datetime.now()
@asyncio.coroutine
def writeRedis():
    count = 0
    while count < 1000000 :
        r.hset("hash1", str(count), a)
        # r.hset("hash1", "k2", "v2")
        # print(r.hget("hash1",count))
        count+=1


if __name__ == '__main__':
	loop = asyncio.get_event_loop()
	loop.run_until_complete(writeRedis())
	loop.close()
	lastTime = datetime.datetime.now()
	spenTime = lastTime - firstTime
	print(spenTime)
	try:
		while True :
			num=random.randint(1,1000000)
			r.hset("hash1",num,b)
			# print(num)
	except:
		print('redis daat not update ')